@startuml toxic-room
title Poison People in a Toxic Room
hide footbox

participant "person : Person" as p
participant "item : Item" as i
participant "effect : Effect" as e

[-> p ++ : poison()
create "visitor : PoisoningVisitor" as v
p -> v : person
loop effect in effects
	p -> e ++: accept(visitor)
	e -> v ++: visit(MaskEffect)
	v --> e --
	e --> p --
end
loop item in items
	p -> i ++: accept(visitor)
	i -> v ++: visit(Mask)
	v -> i ++: use(person)
	i --> v --
	v --> i --
	i --> p --
end

p -> v ++: poison()
opt player was not protected
v -> p ++: knockOut()
p --> v --
end 
v --> p --
[<-- p --

@enduml